const express = require('express');
const app = express();
const port = 3000;

const bodyParser = require('body-parser');
app.use(bodyParser.urlencoded({ extended: true }));

app.set('view engine', 'ejs');
app.use(express.static('public'));

let usuarios = JSON.parse(localStorage.getItem('usuarios')) || [];

app.get('/', (req, res) => {
    res.render('usuarios', { usuarios });
});

app.get('/crear-usuario', (req, res) => {
    res.render('crearUsuario');
});

app.post('/crear-usuario', (req, res) => {
    const nuevoUsuario = {
        id: usuarios.length + 1,
        nombre: req.body.nombre,
        rol: req.body.rol
    };

    usuarios.push(nuevoUsuario);
    localStorage.setItem('usuarios', JSON.stringify(usuarios));

    res.redirect('/');
});

app.listen(port, () => {
    console.log(`Servidor en funcionamiento en http://localhost:${port}`);
});